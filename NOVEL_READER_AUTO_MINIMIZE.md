# 小说阅读器自动最小化功能

## 功能描述

当小说阅读器窗口处于活动状态时，如果鼠标离开窗口或窗口失去焦点，小说阅读器会自动最小化。

## 实现原理

### 1. 自动最小化逻辑

- **鼠标离开窗口**：当鼠标移出小说阅读器窗口边界时，启动 100ms 延迟计时器，如果鼠标没有重新进入窗口，则自动最小化
- **窗口失去焦点**：当小说阅读器窗口失去焦点时，立即最小化窗口

### 2. 技术实现

#### 核心组件

1. **AppWindow.vue** - 窗口组件
   - 添加了鼠标进入/离开事件监听
   - 添加了焦点获得/失去事件监听
   - 针对小说阅读器（`appSlug === 'novel-reader'`）进行特殊处理

2. **useAutoMinimize.js** - 自动最小化 composable
   - 提供最小化调度和取消功能
   - 支持延迟最小化，避免误操作

#### 关键代码

```javascript
// 鼠标离开窗口
function onMouseLeave() {
  if (isNovelReader.value && props.isActive) {
    scheduleMinimize();
  }
}

// 窗口失去焦点
function onFocusOut() {
  if (isNovelReader.value && props.isActive) {
    scheduleMinimize(0); // 立即最小化
  }
}
```

## 使用场景

1. **阅读时临时离开**：用户在阅读小说时，鼠标移出窗口去做其他事情，窗口自动最小化
2. **切换应用**：用户点击其他应用或窗口，小说阅读器自动最小化
3. **避免误操作**：通过延迟机制，避免用户意外移出鼠标导致窗口最小化

## 配置选项

- **延迟时间**：默认 100ms，可在 `useAutoMinimize` 中调整
- **启用状态**：默认启用，可通过 `enabled` 参数控制
- **应用范围**：仅对小说阅读器（`novel-reader`）生效

## 注意事项

1. 只有在窗口处于活动状态时才会触发自动最小化
2. 鼠标重新进入窗口会取消最小化计时器
3. 窗口重新获得焦点会取消最小化计时器
4. 功能仅对小说阅读器生效，不影响其他应用窗口

## 测试方法

1. 打开小说阅读器
2. 将鼠标移出窗口边界
3. 等待 100ms，窗口应该自动最小化
4. 或者点击其他窗口，小说阅读器应该立即最小化
