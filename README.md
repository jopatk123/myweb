# MyWeb - è½»é‡çº§å¤šäººæ¡Œé¢é£æ ¼ Web åº”ç”¨

> ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„ã€ç°ä»£åŒ–çš„ Web åº”ç”¨æ¡†æ¶ï¼Œæä¾›æ¡Œé¢é£æ ¼çš„ç”¨æˆ·ä½“éªŒä¸å¤šäººäº¤äº’èƒ½åŠ›ã€‚

![Node.js](https://img.shields.io/badge/Node.js-20+-green.svg)
![Vue](https://img.shields.io/badge/Vue-3.3+-brightgreen.svg)
![Express](https://img.shields.io/badge/Express-4.18+-blue.svg)
![SQLite](https://img.shields.io/badge/SQLite-3-lightblue.svg)
![Docker](https://img.shields.io/badge/Docker-24+-blue.svg)

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

MyWeb æ˜¯ä¸€ä¸ªåŸºäº **Vue 3 + Express.js + SQLite** çš„å…¨æ ˆ Web åº”ç”¨æ¡†æ¶ï¼Œé€šè¿‡ä»¿æ¡Œé¢æ“ä½œç³»ç»Ÿçš„ç•Œé¢è®¾è®¡ï¼Œè®©ç”¨æˆ·å¯ä»¥åƒåœ¨æœ¬åœ°ç”µè„‘ä¸Šä¸€æ ·ä½¿ç”¨å„ç§åº”ç”¨ã€‚é¡¹ç›®é‡‡ç”¨ npm workspaces ç®¡ç†å¤šä¸ªå­åŒ…ï¼Œæ”¯æŒæœ¬åœ°å¼€å‘å’Œ Docker å®¹å™¨åŒ–éƒ¨ç½²ã€‚

### æŠ€æœ¯æ ˆ

| å±‚çº§         | æŠ€æœ¯           | ç‰ˆæœ¬  | è¯´æ˜                     |
| ------------ | -------------- | ----- | ------------------------ |
| **å‰ç«¯**     | Vue            | 3.3+  | æ¸è¿›å¼ JavaScript æ¡†æ¶   |
|              | Vite           | 7.1+  | è½»é‡çº§å‰ç«¯æ„å»ºå·¥å…·       |
|              | Vue Router     | 4.2+  | å•é¡µåº”ç”¨è·¯ç”±ç®¡ç†         |
|              | Vitest         | 0.34+ | å‰ç«¯å•å…ƒæµ‹è¯•æ¡†æ¶         |
| **åç«¯**     | Express.js     | 4.18+ | è½»é‡çº§ Web æœåŠ¡å™¨æ¡†æ¶    |
|              | Node.js        | 20+   | JavaScript è¿è¡Œæ—¶        |
|              | Knex.js        | 2.5+  | SQL æŸ¥è¯¢æ„å»ºå™¨ä¸è¿ç§»å·¥å…· |
| **æ•°æ®åº“**   | SQLite         | 3     | è½»é‡çº§å…³ç³»æ•°æ®åº“         |
|              | better-sqlite3 | 12.4+ | é«˜æ€§èƒ½ SQLite é©±åŠ¨       |
| **å®æ—¶é€šä¿¡** | WebSocket (ws) | 8.18+ | åŒå‘é€šä¿¡åè®®             |
| **éƒ¨ç½²**     | Docker         | 24+   | å®¹å™¨åŒ–éƒ¨ç½²               |
|              | Docker Compose | 2.0+  | å®¹å™¨ç¼–æ’                 |
| **ä»£ç è´¨é‡** | ESLint         | 9.33+ | JavaScript ä»£ç æ£€æŸ¥      |
|              | Prettier       | 3.6+  | ä»£ç æ ¼å¼åŒ–å·¥å…·           |
|              | Husky          | 9.1+  | Git é’©å­ç®¡ç†             |

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### 1. æ¡Œé¢åŒ–ç”¨æˆ·ç•Œé¢

- ä»¿ Windows/macOS ç³»ç»Ÿçš„æ¡Œé¢é£æ ¼è®¾è®¡
- æ”¯æŒåº”ç”¨çª—å£çš„æ‹–æ‹½ã€æœ€å°åŒ–ã€æœ€å¤§åŒ–ã€å…³é—­æ“ä½œ
- æ”¯æŒå›¾æ ‡å¸ƒå±€ã€å¿«æ·èœå•
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå„ç§å±å¹•å°ºå¯¸

### 2. å†…ç½®åº”ç”¨ç”Ÿæ€

| åº”ç”¨              | åŠŸèƒ½æè¿°                                      | æŠ€æœ¯ç‰¹ç‚¹                                   |
| ----------------- | --------------------------------------------- | ------------------------------------------ |
| ğŸµ **éŸ³ä¹æ’­æ”¾å™¨** | æœ¬åœ°éŸ³é¢‘ä¸Šä¼ ã€æ’­æ”¾ã€å…ƒæ•°æ®æå–ã€æ’­æ”¾åˆ—è¡¨ç®¡ç†  | ffmpeg éŸ³é¢‘å¤„ç†ã€music-metadata å…ƒæ•°æ®è§£æ |
| ğŸ“– **å°è¯´é˜…è¯»å™¨** | æ”¯æŒ TXT/DOCX/EPUB ç­‰æ ¼å¼ã€ä¹¦ç­¾åŒæ­¥ã€è¿›åº¦ä¿å­˜ | mammoth æ–‡æ¡£è§£æã€DOMPurify HTML æ¸…ç†      |
| ğŸ“ **ç¬”è®°æœ¬**     | å³æ—¶ä¾¿ç­¾ã€åˆ†ç±»ç®¡ç†ã€å¿«é€Ÿæœç´¢                  | æœ¬åœ°å­˜å‚¨ã€äº‘åŒæ­¥                           |
| ğŸ **è´ªåƒè›‡**     | å•äººæ¨¡å¼ã€å¤šäººå¯¹æˆ˜ã€å®æ—¶åŒæ­¥                  | WebSocket æˆ¿é—´ç®¡ç†ã€æ¸¸æˆçŠ¶æ€åŒæ­¥           |
| â±ï¸ **å·¥ä½œè®¡æ—¶å™¨** | ç•ªèŒ„å·¥ä½œæ³•è®¡æ—¶ã€ä»»åŠ¡ç»Ÿè®¡ã€æ•°æ®å¯è§†åŒ–          | æ—¶é—´ç»Ÿè®¡åˆ†æ                               |
| âš™ï¸ **è®¡ç®—å™¨**     | æ”¯æŒå¤æ‚æ•°å­¦è¿ç®—ã€å†å²è®°å½•                    | è¡¨è¾¾å¼æ±‚å€¼                                 |
| ğŸ® **äº”å­æ£‹**     | åŒäººå¯¹æˆ˜ã€AI å¯¹æ‰‹ã€èƒœè´Ÿç»Ÿè®¡                   | å®æ—¶æ£‹å±€åŒæ­¥                               |
| ğŸ’¬ **æ¶ˆæ¯ç•™è¨€æ¿** | å¯Œæ–‡æœ¬ç¼–è¾‘ã€å›¾ç‰‡ä¸Šä¼ ã€å®æ—¶åˆ·æ–°                | å›¾ç‰‡å­˜å‚¨ã€å¯Œæ–‡æœ¬æ¸²æŸ“                       |

### 3. å¤šäººå®æ—¶äº¤äº’

- åŸºäº WebSocket çš„å®æ—¶é€šä¿¡å¼•æ“
- æ”¯æŒå¤šäººæ¸¸æˆæˆ¿é—´åˆ›å»ºä¸åŠ å…¥
- ä½å»¶è¿ŸçŠ¶æ€åŒæ­¥
- ç¦»çº¿ç©å®¶è‡ªåŠ¨æ¸…ç†

### 4. æ–‡ä»¶ä¸åª’ä½“ç®¡ç†

- **å¤šæ ¼å¼ä¸Šä¼ **ï¼šå›¾ç‰‡ã€æ–‡æ¡£ã€éŸ³é¢‘ã€è§†é¢‘ç­‰
- **æ–‡ä»¶æµè§ˆå™¨**ï¼šæ ‘å½¢ç›®å½•å±•ç¤ºã€æ–‡ä»¶æœç´¢
- **é¢„è§ˆåŠŸèƒ½**ï¼šå›¾ç‰‡ç¼©ç•¥å›¾ã€æ–‡æ¡£é¢„è§ˆã€è§†é¢‘æ’­æ”¾
- **å£çº¸ç³»ç»Ÿ**ï¼šè‡ªå®šä¹‰èƒŒæ™¯ã€ç¼©ç•¥å›¾ç”Ÿæˆã€åˆ†ç±»ç®¡ç†

### 5. æ•°æ®æŒä¹…åŒ–

- **æ•°æ®åº“**ï¼šSQLite å…³ç³»æ•°æ®åº“ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢
- **æ•°æ®è¿ç§»**ï¼šKnex.js ç‰ˆæœ¬æ§åˆ¶æœºåˆ¶
- **ä¸Šä¼ å­˜å‚¨**ï¼šæ”¯æŒæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨
- **å®¹å™¨åŒ–æŒä¹…åŒ–**ï¼šDocker volumes æ•°æ®å·æŒ‚è½½

### 6. ç°ä»£åŒ–å¼€å‘ä½“éªŒ

- **å¿«é€Ÿçƒ­é‡è½½**ï¼šVite æ¯«ç§’çº§ä¿®æ”¹åé¦ˆ
- **ç±»å‹å®‰å…¨**ï¼šJavaScript ä»£ç è´¨é‡æ£€æŸ¥
- **è‡ªåŠ¨æ ¼å¼åŒ–**ï¼šPrettier é£æ ¼ç»Ÿä¸€
- **Git é’©å­**ï¼šHusky æäº¤å‰æ£€æŸ¥
- **å•å…ƒæµ‹è¯•**ï¼šJest/Vitest æµ‹è¯•æ¡†æ¶

---

## ğŸ“‚ é¡¹ç›®ç»“æ„è¯¦è§£

```
myweb/
â”œâ”€â”€ client/                           # å‰ç«¯ Vue 3 åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.js                  # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ App.vue                  # æ ¹ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ apps/                    # å†…ç½®åº”ç”¨æ³¨å†Œè¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ registry.js          # åº”ç”¨æ³¨å†Œä¸­å¿ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ calculator/          # è®¡ç®—å™¨åº”ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ music-player/        # éŸ³ä¹æ’­æ”¾å™¨åº”ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ notebook/            # ç¬”è®°æœ¬åº”ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ novel-reader/        # å°è¯´é˜…è¯»å™¨åº”ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ snake/               # è´ªåƒè›‡åº”ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ gomoku/              # äº”å­æ£‹åº”ç”¨
â”‚   â”‚   â”‚   â””â”€â”€ work-timer/          # å·¥ä½œè®¡æ—¶å™¨åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ components/              # Vue ç»„ä»¶åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ desktop/             # æ¡Œé¢å®¹å™¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ app/                 # åº”ç”¨çª—å£æ¡†æ¶ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ common/              # é€šç”¨ç»„ä»¶ï¼ˆæŒ‰é’®ã€è¾“å…¥æ¡†ç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ file/                # æ–‡ä»¶ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ preview/             # æ–‡ä»¶é¢„è§ˆç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ wallpaper/           # å£çº¸ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ message-board/       # æ¶ˆæ¯ç•™è¨€æ¿ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ multiplayer/         # å¤šäººäº¤äº’ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ composables/             # Vue ç»„åˆå¼ API é€»è¾‘å¤ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ useApps.js           # åº”ç”¨ç®¡ç†é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ useAppWindowResize.js # çª—å£æ‹–æ‹½ç¼©æ”¾
â”‚   â”‚   â”‚   â”œâ”€â”€ useContextMenu.js    # å³é”®èœå•
â”‚   â”‚   â”‚   â”œâ”€â”€ useDesktopDropZone.js # æ¡Œé¢æ‹–æ‹½ä¸Šä¼ 
â”‚   â”‚   â”‚   â”œâ”€â”€ useAILogs.js         # AI æ—¥å¿—æ”¶é›†
â”‚   â”‚   â”‚   â”œâ”€â”€ filePreview.js       # æ–‡ä»¶é¢„è§ˆé€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ ...å…¶ä»–ç»„åˆå¼ API
â”‚   â”‚   â”œâ”€â”€ api/                     # API å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ httpClient.js        # Axios å®ä¾‹é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ files.js             # æ–‡ä»¶æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ music.js             # éŸ³ä¹æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ notebook.js          # ç¬”è®°æœ¬æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ wallpaper.js         # å£çº¸æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ worktimer.js         # è®¡æ—¶å™¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ message.js           # æ¶ˆæ¯æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ bookmarks.js         # ä¹¦ç­¾æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ snake-multiplayer.js # è´ªåƒè›‡å¤šäººæ¥å£
â”‚   â”‚   â”œâ”€â”€ services/                # å‰ç«¯æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ store/                   # çŠ¶æ€ç®¡ç†ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ router/                  # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ styles/                  # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ constants/               # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ tests/                       # å‰ç«¯æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”‚   â””â”€â”€ setup/                   # æµ‹è¯•é…ç½®
â”‚   â”œâ”€â”€ public/                      # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ apps/icons/              # åº”ç”¨å›¾æ ‡
â”‚   â”œâ”€â”€ coverage/                    # æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
â”‚   â”œâ”€â”€ vite.config.js               # Vite æ„å»ºé…ç½®
â”‚   â”œâ”€â”€ package.json                 # å‰ç«¯ä¾èµ–é…ç½®
â”‚   â””â”€â”€ index.html                   # HTML å…¥å£
â”‚
â”œâ”€â”€ server/                          # Express åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ server.js                # æœåŠ¡å™¨å¯åŠ¨æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ app.js                   # Express åº”ç”¨å®ä¾‹
â”‚   â”‚   â”œâ”€â”€ appFactory.js            # åº”ç”¨å·¥å‚å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ config/                  # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ env.js               # ç¯å¢ƒå˜é‡è§£æ
â”‚   â”‚   â”‚   â””â”€â”€ database.js          # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”œâ”€â”€ constants/               # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ index.js             # å¸¸é‡æ±‡æ€»
â”‚   â”‚   â”œâ”€â”€ middleware/              # Express ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ errorHandler.js      # å…¨å±€é”™è¯¯å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ authentication.js    # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ rateLimit.js         # é€Ÿç‡é™åˆ¶
â”‚   â”‚   â”‚   â””â”€â”€ logger.js            # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ routes/                  # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ apps.routes.js       # åº”ç”¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ files.routes.js      # æ–‡ä»¶æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ music.routes.js      # éŸ³ä¹æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ notebook-notes.routes.js # ç¬”è®°æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ novel-bookmarks.routes.js # ä¹¦ç­¾æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ wallpapers.routes.js # å£çº¸æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ worktimer.routes.js  # è®¡æ—¶å™¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ messages.routes.js   # æ¶ˆæ¯æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ snake-multiplayer.routes.js # æ¸¸æˆæ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ log.routes.js        # æ—¥å¿—æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ internal.logs.routes.js # å†…éƒ¨æ—¥å¿—æ¥å£
â”‚   â”‚   â”œâ”€â”€ controllers/             # è·¯ç”±å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ files.controller.js
â”‚   â”‚   â”‚   â”œâ”€â”€ music.controller.js
â”‚   â”‚   â”‚   â”œâ”€â”€ notebook.controller.js
â”‚   â”‚   â”‚   â”œâ”€â”€ wallpaper.controller.js
â”‚   â”‚   â”‚   â”œâ”€â”€ worktimer.controller.js
â”‚   â”‚   â”‚   â””â”€â”€ ...å…¶ä»–æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ services/                # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ websocket.service.js # WebSocket æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ file.service.js      # æ–‡ä»¶ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ music.service.js     # éŸ³ä¹ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ wallpaper.service.js # å£çº¸ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ ...å…¶ä»–æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ music.model.js       # éŸ³ä¹æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ wallpaper.model.js   # å£çº¸æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ notebook.model.js    # ç¬”è®°æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ ...å…¶ä»–æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ db/                      # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js             # æ•°æ®åº“å®ä¾‹
â”‚   â”‚   â”‚   â””â”€â”€ init.js              # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ migrations/              # æ•°æ®åº“è¿ç§»è„šæœ¬ï¼ˆKnexï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ 001_init_schema.js
â”‚   â”‚   â”‚   â””â”€â”€ ...å…¶ä»–è¿ç§»
â”‚   â”‚   â”œâ”€â”€ seeds/                   # æ•°æ®åº“åˆå§‹åŒ–æ•°æ®
â”‚   â”‚   â”‚   â””â”€â”€ seed_default_data.js
â”‚   â”‚   â”œâ”€â”€ dto/                     # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆéªŒè¯ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ music.dto.js
â”‚   â”‚   â”‚   â”œâ”€â”€ file.dto.js
â”‚   â”‚   â”‚   â””â”€â”€ ...å…¶ä»– DTO
â”‚   â”‚   â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ file-helper.js       # æ–‡ä»¶æ“ä½œå·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ logger.js            # æ—¥å¿—å·¥å…·ï¼ˆPinoï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ health-check.js      # å¥åº·æ£€æŸ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ db-check.js          # æ•°æ®åº“æ£€æŸ¥
â”‚   â”‚   â”‚   â””â”€â”€ validators.js        # éªŒè¯å·¥å…·
â”‚   â”‚   â””â”€â”€ constants/               # å¸¸é‡
â”‚   â”œâ”€â”€ tests/                       # åç«¯æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ app.health.test.js       # å¥åº·æ£€æŸ¥æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ apps.routes.test.js      # åº”ç”¨è·¯ç”±æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ files.routes.test.js     # æ–‡ä»¶è·¯ç”±æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ music.service.test.js    # éŸ³ä¹æœåŠ¡æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ wallpaper.service.test.js # å£çº¸æœåŠ¡æµ‹è¯•
â”‚   â”‚   â””â”€â”€ helpers/                 # æµ‹è¯•è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ data/                        # æ•°æ®åº“æ–‡ä»¶ç›®å½•
â”‚   â”‚   â””â”€â”€ myweb.db                 # SQLite æ•°æ®åº“
â”‚   â”œâ”€â”€ logs/                        # æ—¥å¿—è¾“å‡ºç›®å½•
â”‚   â”‚   â””â”€â”€ *.log                    # åº”ç”¨æ—¥å¿—
â”‚   â”œâ”€â”€ uploads/                     # ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ files/                   # æ™®é€šæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ music/                   # éŸ³ä¹æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ wallpapers/              # å£çº¸å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ novels/                  # å°è¯´æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ apps/                    # åº”ç”¨å›¾æ ‡
â”‚   â”‚   â””â”€â”€ message-images/          # ç•™è¨€æ¿å›¾ç‰‡
â”‚   â”œâ”€â”€ coverage/                    # æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
â”‚   â”œâ”€â”€ knexfile.cjs                 # Knex è¿ç§»é…ç½®
â”‚   â”œâ”€â”€ jest.config.cjs              # Jest æµ‹è¯•é…ç½®
â”‚   â”œâ”€â”€ openapi.yaml                 # REST API è§„èŒƒæ–‡æ¡£ï¼ˆOpenAPI 3.0ï¼‰
â”‚   â””â”€â”€ package.json                 # åç«¯ä¾èµ–é…ç½®
â”‚
â”œâ”€â”€ docs/                            # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ deploy.sh                        # Docker éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ build_myweb_images_tar.sh        # é•œåƒæ‰“åŒ…å·¥å…·
â”œâ”€â”€ docker-compose.yml               # å®¹å™¨ç¼–æ’é…ç½®
â”œâ”€â”€ Dockerfile                       # å¤šé˜¶æ®µæ„å»ºæ–‡ä»¶
â”œâ”€â”€ .env.example                     # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                       # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ eslint.config.js                 # ESLint è§„åˆ™é…ç½®
â”œâ”€â”€ jest.config.cjs                  # æ ¹ç›®å½• Jest é…ç½®
â”œâ”€â”€ package.json                     # é¡¹ç›®æ ¹é…ç½®ï¼ˆnpm workspacesï¼‰
â””â”€â”€ README.md                        # æœ¬æ–‡ä»¶
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

| ç»„ä»¶               | ç‰ˆæœ¬ | è¯´æ˜                    |
| ------------------ | ---- | ----------------------- |
| **Node.js**        | â‰¥ 20 | å¿…éœ€ï¼Œå»ºè®®æœ€æ–° LTS ç‰ˆæœ¬ |
| **npm**            | â‰¥ 9  | å¿…éœ€ï¼Œæ”¯æŒ workspaces   |
| **Docker**         | â‰¥ 24 | å¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²    |
| **Docker Compose** | 2.0+ | å¯é€‰ï¼Œç”¨äºå®¹å™¨ç¼–æ’      |

### æœ¬åœ°å¼€å‘

#### 1ï¸âƒ£ å…‹éš†ä»£ç å¹¶å®‰è£…ä¾èµ–

```bash
git clone https://github.com/jopatk123/myweb.git
cd myweb
npm install
```

#### 2ï¸âƒ£ å‡†å¤‡ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
```

æ ¹æ®éœ€è¦ç¼–è¾‘ `.env` æ–‡ä»¶ä¸­çš„å…³é”®å˜é‡ï¼ˆè¯¦è§ä¸‹æ–‡ç¯å¢ƒå˜é‡ç« èŠ‚ï¼‰ã€‚

#### 3ï¸âƒ£ å¯åŠ¨å¼€å‘æ¨¡å¼

```bash
npm run dev
```

è¿™å°†å¹¶è¡Œå¯åŠ¨ï¼š

- **å‰ç«¯ Vite dev server**ï¼š[http://localhost:3000](http://localhost:3000)
- **åç«¯ Express server**ï¼š[http://localhost:3000](http://localhost:3000)ï¼ˆç”± `.env` ä¸­çš„ `BACKEND_PORT` æ§åˆ¶ï¼Œé»˜è®¤ 3000ï¼‰
- Vite è‡ªåŠ¨ä»£ç† `/api` å’Œ `/ws` è¯·æ±‚åˆ°åç«¯

**å•ç‹¬å¯åŠ¨ï¼ˆè°ƒè¯•ç”¨ï¼‰**ï¼š

```bash
npm run dev:client    # ä»…å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev:server    # ä»…å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨
```

#### 4ï¸âƒ£ éªŒè¯å®‰è£…

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® [http://localhost:3000](http://localhost:3000)ï¼Œåº”è¯¥çœ‹åˆ° MyWeb æ¡Œé¢ç•Œé¢ã€‚

#### 5ï¸âƒ£ ç”Ÿäº§æ„å»º

```bash
# æ„å»ºå‰åç«¯ï¼ˆç”Ÿæˆ client/distï¼‰
npm run build

# æœ¬åœ°ç”Ÿäº§æ¨¡å¼è¿è¡Œï¼ˆéœ€å…ˆæ‰§è¡Œ buildï¼‰
npm start
```

---

## ğŸ“ å¸¸ç”¨è„šæœ¬

### å¼€å‘å‘½ä»¤

| å‘½ä»¤                 | è¯´æ˜                          |
| -------------------- | ----------------------------- |
| `npm run dev`        | å¹¶è¡Œå¯åŠ¨å‰ç«¯ä¸åç«¯å¼€å‘æœåŠ¡    |
| `npm run dev:client` | ä»…å¯åŠ¨å‰ç«¯ Vite å¼€å‘æœåŠ¡å™¨    |
| `npm run dev:server` | ä»…å¯åŠ¨åç«¯ Express å¼€å‘æœåŠ¡å™¨ |

### æ„å»ºä¸è¿è¡Œ

| å‘½ä»¤                   | è¯´æ˜                                 |
| ---------------------- | ------------------------------------ |
| `npm run build`        | æ„å»ºåç«¯+å‰ç«¯ï¼ˆç”Ÿæˆ `client/dist/`ï¼‰ |
| `npm run build:client` | ä»…æ„å»ºå‰ç«¯                           |
| `npm run build:server` | ä»…æ„å»ºåç«¯                           |
| `npm start`            | ç”Ÿäº§æ¨¡å¼å¯åŠ¨åç«¯æœåŠ¡                 |

### ä»£ç è´¨é‡

| å‘½ä»¤                   | è¯´æ˜                    |
| ---------------------- | ----------------------- |
| `npm run lint`         | ESLint æ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤   |
| `npm run lint:check`   | ESLint ä»…æ£€æŸ¥ä¸ä¿®å¤     |
| `npm run format`       | Prettier æ ¼å¼åŒ–æ‰€æœ‰æ–‡ä»¶ |
| `npm run format:check` | Prettier æ£€æŸ¥æ ¼å¼       |

### æµ‹è¯•

| å‘½ä»¤                         | è¯´æ˜                                |
| ---------------------------- | ----------------------------------- |
| `npm test -w server`         | è¿è¡Œåç«¯ Jest æµ‹è¯•                  |
| `npm test -w client`         | è¿è¡Œå‰ç«¯ Vitest æµ‹è¯•                |
| `npm run test:cov -w server` | åç«¯æµ‹è¯•+è¦†ç›–ç‡                     |
| `npm run test:cov -w client` | å‰ç«¯æµ‹è¯•+è¦†ç›–ç‡                     |
| `npm run contract-test`      | æ£€æŸ¥ `server/openapi.yaml` API è§„èŒƒ |

### æ•°æ®åº“ç®¡ç†ï¼ˆåç«¯ä¸“ç”¨ï¼‰

| å‘½ä»¤                                 | è¯´æ˜                      |
| ------------------------------------ | ------------------------- |
| `npm run migrate -w server`          | æ‰§è¡Œæ•°æ®åº“è¿ç§»            |
| `npm run migrate:rollback -w server` | å›æ»šä¸Šä¸€æ¬¡è¿ç§»            |
| `npm run seed -w server`             | æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–æ•°æ®      |
| `npm run db:setup -w server`         | è¿ç§»+æ£€æŸ¥ï¼ˆåˆå§‹åŒ–æ•°æ®åº“ï¼‰ |
| `npm run db:check -w server`         | æ£€æŸ¥æ•°æ®åº“çŠ¶æ€            |

---

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

### æ ¸å¿ƒå˜é‡

| å˜é‡                    | é»˜è®¤å€¼           | è¯´æ˜                               |
| ----------------------- | ---------------- | ---------------------------------- |
| `NODE_ENV`              | `development`    | è¿è¡Œç¯å¢ƒï¼ˆdevelopment/productionï¼‰ |
| `PORT` / `BACKEND_PORT` | `3000` / `10010` | åç«¯å¯¹å¤–æš´éœ²ç«¯å£                   |
| `FRONTEND_PORT`         | `3000`           | å‰ç«¯ Vite dev æœåŠ¡å™¨ç«¯å£           |

### API ä¸è·¨åŸŸ

| å˜é‡                   | é»˜è®¤å€¼     | è¯´æ˜                               |
| ---------------------- | ---------- | ---------------------------------- |
| `VITE_API_BASE`        | `/api`     | å‰ç«¯æ„å»ºæ—¶çš„ API åŸºç¡€è·¯å¾„          |
| `DEPLOY_VITE_API_BASE` | _(æœªè®¾ç½®)_ | éƒ¨ç½²è„šæœ¬ä¸“ç”¨ï¼Œè¦†ç›– `VITE_API_BASE` |
| `CORS_ORIGIN`          | `*`        | åç«¯å…è®¸çš„è·¨åŸŸæ¥æº                 |

### æ€§èƒ½ä¸é™åˆ¶

| å˜é‡                        | é»˜è®¤å€¼   | è¯´æ˜                 |
| --------------------------- | -------- | -------------------- |
| `RATE_LIMIT`                | `5000`   | 15 åˆ†é’Ÿå†…æœ€å¤§è¯·æ±‚æ•°  |
| `BODY_LIMIT`                | `2000mb` | è¯·æ±‚ä½“å¤§å°é™åˆ¶       |
| `FILE_MAX_UPLOAD_SIZE`      | `1gb`    | é€šç”¨æ–‡ä»¶ä¸Šä¼ é™åˆ¶     |
| `FILE_MAX_UPLOAD_FILES`     | `100`    | å•æ¬¡ä¸Šä¼ æ–‡ä»¶æ•°é‡é™åˆ¶ |
| `MUSIC_MAX_UPLOAD_SIZE`     | `1gb`    | éŸ³ä¹æ–‡ä»¶ä¸Šä¼ é™åˆ¶     |
| `MUSIC_MAX_UPLOAD_FILES`    | `300`    | éŸ³ä¹å•æ¬¡ä¸Šä¼ æ•°é‡     |
| `WALLPAPER_MAX_UPLOAD_SIZE` | `300mb`  | å£çº¸ä¸Šä¼ é™åˆ¶         |
| `APP_ICON_MAX_UPLOAD_SIZE`  | `100mb`  | åº”ç”¨å›¾æ ‡ä¸Šä¼ é™åˆ¶     |
| `MESSAGE_IMAGE_MAX_SIZE`    | `8mb`    | ç•™è¨€æ¿å•å›¾å¤§å°é™åˆ¶   |
| `MESSAGE_IMAGE_MAX_FILES`   | `5`      | ç•™è¨€æ¿å•æ¬¡ä¸Šä¼ å›¾ç‰‡æ•° |

### Docker ä¸éƒ¨ç½²

| å˜é‡                      | é»˜è®¤å€¼      | è¯´æ˜                   |
| ------------------------- | ----------- | ---------------------- |
| `SKIP_SERVER_NPM_INSTALL` | `0`         | è·³è¿‡å®¹å™¨å†… npm install |
| `USE_LOCAL_CLIENT`        | `0`         | ä½¿ç”¨æœ¬åœ°æ„å»ºçš„å‰ç«¯äº§ç‰© |
| `COMPOSE_PROJECT_NAME`    | `myweb`     | Docker Compose é¡¹ç›®å  |
| `DOCKER_BUILDKIT`         | `1`         | å¯ç”¨ Docker BuildKit   |
| `DOMAIN`                  | `localhost` | éƒ¨ç½²åŸŸå               |

---

## ğŸ“¡ API æ¥å£æ¦‚è§ˆ

åç«¯æä¾›äº† RESTful API æ¥å£å’Œ WebSocket æ”¯æŒã€‚è¯¦ç»†æ–‡æ¡£è§ `server/openapi.yaml`ã€‚

### æ ¸å¿ƒç«¯ç‚¹

#### åº”ç”¨ç®¡ç†

- `GET /api/myapps` â€” è·å–å·²æ³¨å†Œçš„æ¡Œé¢åº”ç”¨åˆ—è¡¨

#### æ–‡ä»¶ç®¡ç†

- `POST /api/files/upload` â€” ä¸Šä¼ æ–‡ä»¶
- `GET /api/files` â€” è·å–æ–‡ä»¶åˆ—è¡¨
- `GET /api/files/:id` â€” è·å–æ–‡ä»¶è¯¦æƒ…
- `DELETE /api/files/:id` â€” åˆ é™¤æ–‡ä»¶

#### éŸ³ä¹ç®¡ç†

- `GET /api/music/tracks` â€” è·å–éŸ³ä¹åˆ—è¡¨
- `POST /api/music/upload` â€” ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶
- `GET /api/music/:id/metadata` â€” è·å–éŸ³ä¹å…ƒæ•°æ®

#### å£çº¸ç®¡ç†

- `GET /api/wallpapers` â€” è·å–å£çº¸åˆ—è¡¨
- `POST /api/wallpapers/upload` â€” ä¸Šä¼ å£çº¸
- `GET /api/wallpapers/:id/thumbnail` â€” è·å–ç¼©ç•¥å›¾

#### ç¬”è®°ç®¡ç†

- `GET /api/notebook/notes` â€” è·å–ç¬”è®°åˆ—è¡¨
- `POST /api/notebook/notes` â€” åˆ›å»ºç¬”è®°
- `PUT /api/notebook/notes/:id` â€” æ›´æ–°ç¬”è®°
- `DELETE /api/notebook/notes/:id` â€” åˆ é™¤ç¬”è®°

#### å°è¯´ä¹¦ç­¾

- `GET /api/bookmarks` â€” è·å–æ‰€æœ‰ä¹¦ç­¾
- `POST /api/bookmarks` â€” åˆ›å»ºä¹¦ç­¾
- `PUT /api/bookmarks/:id` â€” æ›´æ–°ä¹¦ç­¾
- `DELETE /api/bookmarks/:id` â€” åˆ é™¤ä¹¦ç­¾

#### å·¥ä½œè®¡æ—¶

- `GET /api/worktimer/records` â€” è·å–è®¡æ—¶è®°å½•
- `POST /api/worktimer/records` â€” æ–°å¢è®¡æ—¶è®°å½•
- `GET /api/worktimer/statistics` â€” è·å–ç»Ÿè®¡ä¿¡æ¯

#### æ¶ˆæ¯ç•™è¨€æ¿

- `GET /api/messages` â€” è·å–ç•™è¨€åˆ—è¡¨
- `POST /api/messages` â€” å‘è¡¨ç•™è¨€
- `DELETE /api/messages/:id` â€” åˆ é™¤ç•™è¨€

#### å¤šäººæ¸¸æˆ

- `GET /api/snake/rooms` â€” è·å–è´ªåƒè›‡æ¸¸æˆæˆ¿é—´
- `GET /api/snake/rooms/:roomCode` â€” è·å–æˆ¿é—´è¯¦æƒ…
- `WebSocket /ws` â€” å®æ—¶æ¸¸æˆé€šä¿¡

---

## ğŸ³ Docker éƒ¨ç½²

### æ–¹æ¡ˆä¸€ï¼šä¸€é”®éƒ¨ç½²è„šæœ¬

```bash
chmod +x deploy.sh
./deploy.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œï¼š

1. è¯»å– `.env` ç¯å¢ƒå˜é‡
2. æ£€æŸ¥ä¾èµ–ç¯å¢ƒ
3. æ„å»º Docker é•œåƒ
4. å¯åŠ¨å®¹å™¨
5. æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–
6. è¿è¡Œå¥åº·æ£€æŸ¥

**å¸¸ç”¨é€‰é¡¹**ï¼š

```bash
./deploy.sh --no-build              # è·³è¿‡é•œåƒæ„å»ºï¼Œç›´æ¥å¯åŠ¨
./deploy.sh --force-recreate        # å¼ºåˆ¶é‡å»ºå®¹å™¨
./deploy.sh --skip-health-check     # è·³è¿‡å¥åº·æ£€æŸ¥
./deploy.sh --health-timeout 300    # è‡ªå®šä¹‰å¥åº·æ£€æŸ¥è¶…æ—¶ï¼ˆç§’ï¼‰
```

æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹ï¼š

```bash
./deploy.sh --help
```

### æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨ Docker Compose

```bash
# åŠ è½½ç¯å¢ƒå˜é‡å¹¶å¯åŠ¨å®¹å™¨
export $(cat .env | xargs)
docker compose up -d --build

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f myweb

# åœæ­¢å®¹å™¨
docker compose down

# å®Œå…¨æ¸…ç†ï¼ˆåŒ…æ‹¬æ•°æ®å·ï¼‰
docker compose down -v
```

### ç¦»çº¿é•œåƒæ‰“åŒ…

ç”¨äºåœ¨ä¸èƒ½ç›´æ¥è®¿é—®äº’è”ç½‘çš„ç¯å¢ƒä¸­éƒ¨ç½²ï¼š

```bash
chmod +x build_myweb_images_tar.sh
./build_myweb_images_tar.sh -o dist/myweb-images.tar

# åœ¨ç›®æ ‡ä¸»æœºåŠ è½½é•œåƒ
docker load < dist/myweb-images.tar

# å¯åŠ¨å®¹å™¨
docker compose up -d
```

---

## ğŸ’¾ æ•°æ®ä¸å­˜å‚¨

### æ•°æ®åº“

- **ä½ç½®**ï¼š`server/data/myweb.db`ï¼ˆSQLiteï¼‰
- **åˆå§‹åŒ–**ï¼š`npm run db:setup -w server`
- **å¤‡ä»½**ï¼šç›´æ¥å¤åˆ¶ `.db` æ–‡ä»¶æˆ–é€šè¿‡ Docker å·å¤‡ä»½

### ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶

- **ä½ç½®**ï¼š`server/uploads/`
- **å­ç›®å½•**ï¼š
  - `files/` â€” æ™®é€šæ–‡ä»¶
  - `music/` â€” éŸ³ä¹æ–‡ä»¶
  - `wallpapers/` â€” å£çº¸å›¾ç‰‡
  - `novels/` â€” å°è¯´æ–‡ä»¶
  - `apps/` â€” åº”ç”¨å›¾æ ‡
  - `message-images/` â€” ç•™è¨€æ¿å›¾ç‰‡

### Docker æŒä¹…åŒ–å·

åœ¨ `docker-compose.yml` ä¸­å®šä¹‰ï¼š

- `myweb-data` â€” æ•°æ®åº“å­˜å‚¨
- `myweb-uploads` â€” ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
- `myweb-logs` â€” åº”ç”¨æ—¥å¿—

---

## ğŸ§ª æµ‹è¯•

### å‰ç«¯æµ‹è¯•ï¼ˆVitestï¼‰

```bash
# è¿è¡Œæ‰€æœ‰å‰ç«¯æµ‹è¯•
npm test -w client

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:cov -w client

# ç›‘å¬æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è¿è¡Œï¼‰
npm run test:watch -w client

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
open client/coverage/lcov-report/index.html
```

### åç«¯æµ‹è¯•ï¼ˆJestï¼‰

```bash
# è¿è¡Œæ‰€æœ‰åç«¯æµ‹è¯•
npm test -w server

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:cov -w server

# ç›‘å¬æ¨¡å¼
npm run test:watch -w server

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
open server/coverage/lcov-report/index.html
```

### API è§„èŒƒæ£€æŸ¥

```bash
# æ£€æŸ¥ OpenAPI æ–‡æ¡£è§„èŒƒ
npm run contract-test

# æŸ¥çœ‹æ£€æŸ¥ç»“æœ
cat contract-report.json
```

---
